# ===== Virtio MMIO Command Line Device Support =====
# CRITICAL: Required for Firecracker to pass virtio device info via kernel cmdline
# Without this, virtio_mmio.device= parameters are ignored and root device fails
CONFIG_VIRTIO_MMIO_CMDLINE_DEVICES=y

# ===== Docker Bridge Networking Support =====
# Required for Docker's default bridge network mode
# Without these, Docker falls back to --network=host

# IPv4 raw table (Docker bridge requirement)
CONFIG_IP_NF_RAW=y

# IPv6 iptables support (for dual-stack containers)
CONFIG_IP6_NF_RAW=y

# Connection tracking target (used by Docker for NAT)
CONFIG_NETFILTER_XT_TARGET_CT=y

# Additional netfilter modules commonly used by Docker
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=y
CONFIG_NETFILTER_XT_MATCH_IPVS=y

# Ensure bridge netfilter is enabled (usually already set)
CONFIG_BRIDGE_NETFILTER=y
CONFIG_NF_CONNTRACK_BRIDGE=y

# pcie.config
CONFIG_BLK_MQ_PCI=y
CONFIG_PCI=y
CONFIG_PCI_MMCONFIG=y
CONFIG_PCI_MSI=y
CONFIG_PCIEPORTBUS=y
CONFIG_VIRTIO_PCI=y
CONFIG_PCI_HOST_COMMON=y
CONFIG_PCI_HOST_GENERIC=y

# virtio-mem.config
CONFIG_VIRTIO_MEM=y
CONFIG_STRICT_DEVMEM=y

# virtio-pmem.config
# Needed for DAX on aarch64. Will be ignored on x86_64
CONFIG_ARM64_PMEM=y
CONFIG_DEVICE_MIGRATION=y
CONFIG_ZONE_DEVICE=y
CONFIG_VIRTIO_PMEM=y
CONFIG_LIBNVDIMM=y
CONFIG_BLK_DEV_PMEM=y
CONFIG_ND_CLAIM=y
CONFIG_ND_BTT=y
CONFIG_BTT=y
CONFIG_ND_PFN=y
CONFIG_NVDIMM_PFN=y
CONFIG_NVDIMM_DAX=y
CONFIG_OF_PMEM=y
CONFIG_NVDIMM_KEYS=y
CONFIG_DAX=y
CONFIG_DEV_DAX=y
CONFIG_DEV_DAX_PMEM=y
CONFIG_DEV_DAX_KMEM=y
CONFIG_FS_DAX=y
CONFIG_FS_DAX_PMD=y

# vmclock.config
CONFIG_PTP_1588_CLOCK_VMCLOCK=y