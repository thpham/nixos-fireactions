# Example multi-stage Dockerfile for testing fireactions runners
# Stage 1: Build
FROM golang:1.24-alpine AS builder

WORKDIR /app

# Install build dependencies
RUN apk add --no-cache git ca-certificates

# Copy Go source files
COPY tests/go.mod tests/main.go ./

# Build the application
RUN CGO_ENABLED=0 GOOS=linux go build -ldflags="-w -s" -o /app/hello .

# Stage 2: Runtime
FROM alpine:3.23 AS runtime

# Install runtime dependencies
RUN apk add --no-cache ca-certificates tzdata

# Create non-root user
RUN adduser -D -g '' appuser

WORKDIR /app

# Copy binary from builder
COPY --from=builder /app/hello .

# Use non-root user
USER appuser

# Run the application
CMD ["./hello"]
